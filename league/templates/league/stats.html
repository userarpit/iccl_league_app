{% extends 'league/base.html' %}

{% block content %}
<h2 class="text-3xl font-bold text-gray-700 mb-6">üìä Statistics</h2>

<div class="bg-white p-6 rounded-lg shadow-md">
    <div class="border-b border-gray-200">
        <nav class="-mb-px flex space-x-8" aria-label="Tabs">
            <a href="#" class="tab-link border-b-2 py-4 px-1 text-sm font-medium border-indigo-500 text-indigo-600"
                data-tab="goals-tab">
                Goals
            </a>
            <a href="#"
                class="tab-link border-b-2 py-4 px-1 text-sm font-medium border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
                data-tab="yellow-cards-tab">
                Yellow Cards
            </a>
            <a href="#"
                class="tab-link border-b-2 py-4 px-1 text-sm font-medium border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
                data-tab="red-cards-tab">
                Red Cards
            </a>
            <a href="#"
                class="tab-link border-b-2 py-4 px-1 text-sm font-medium border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
                data-tab="motm-tab">
                Man of the Match
            </a>
            <a href="#"
                class="tab-link border-b-2 py-4 px-1 text-sm font-medium border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
                data-tab="totw-tab">
                Team of the Week
            </a>
        </nav>
    </div>

    <div id="goals-tab" class="tab-content mt-4">
        <h3 class="text-xl font-semibold text-green-700 mb-4">‚öΩ Goal Scorers</h3>
        <div class="min-w-full">
            <div class="flex text-gray-600 border-b border-gray-200 py-2">
                <div class="w-1/2 text-left font-semibold">Player</div>
                <div class="w-1/2 pl-4 font-semibold">Goals</div>
            </div>
            {% for player in top_scorers %}
            <div class="flex items-center border-t border-gray-200 py-2">
                <span class="w-1/2">{{ player.player__name }} 
                    <span class="text-xs text-gray-500">({{player.player__team__name }})</span>
                </span>
                <span class="w-1/2 pl-4 font-medium text-green-600">{{ player.total_goals }}</span>
            </div>
            {% endfor %}
        </div>
    </div>

    <div id="yellow-cards-tab" class="tab-content mt-4 hidden">
        <h3 class="text-xl font-semibold text-yellow-500 mb-4">üü® Top Yellow Cards</h3>
        <div class="min-w-full">
            <div class="flex text-gray-600 border-b border-gray-200 py-2">
                <div class="w-1/2 text-left font-semibold">Player</div>
                <div class="w-1/2 pl-4 font-semibold">Cards</div>
            </div>
            {% for player in yellow_cards %}
            <div class="flex items-center border-t border-gray-200 py-2">
                <span class="w-1/2">{{ player.player__name }} 
                    <span class="text-xs text-gray-500">({{ player.player__team__name }})</span>
                </span>
                <span class="w-1/2 pl-4 font-medium text-yellow-600">{{ player.total_yellows }}</span>
            </div>
            {% endfor %}
        </div>
    </div>

    <div id="red-cards-tab" class="tab-content mt-4 hidden">
        <h3 class="text-xl font-semibold text-red-700 mb-4">üü• Top Red Cards</h3>
        <div class="min-w-full">
            <div class="flex text-gray-600 border-b border-gray-200 py-2">
                <div class="w-1/2 text-left font-semibold">Player</div>
                <div class="w-1/2 pl-4 font-semibold">Cards</div>
            </div>
            {% for player in red_cards %}
            <div class="flex items-center border-t border-gray-200 py-2">
                <span class="w-1/2">{{ player.player__name }}
                    <span class="text-xs text-gray-500">({{ player.player__team__name }})</span>
                </span>
                <span class="w-1/2 pl-4 font-medium text-red-600">{{ player.total_reds }}</span>
            </div>
            {% endfor %}
        </div>
    </div>

    <div id="motm-tab" class="tab-content mt-4 hidden">
        <h3 class="text-xl font-semibold text-blue-700 mb-4">‚≠ê Man of the Match</h3>
        <div class="min-w-full">
            <div class="flex text-gray-600 border-b border-gray-200 py-2">
                <div class="w-1/2 text-left font-semibold">Player</div>
                <div class="w-1/2 pl-4 font-semibold">Count (Weeks)</div>
            </div>
            {% for motm in motm_list %}
            <div class="flex items-center border-t border-gray-200 py-2">
                <span class="w-1/2">
                    {{ motm.mom__name }}
                    <span class="text-xs text-gray-500">({{ motm.mom__team__name }})</span>
                </span>
                <span class="w-1/2 pl-4 font-medium text-blue-600">
                    {{ motm.total_mom_count }}
                    <span class="text-xs text-gray-500">
                        ({{ motm.week_numbers|join:", " }})
                    </span>
                </span>
            </div>
            {% endfor %}
        </div>
    </div>

    <div id="totw-tab" class="tab-content mt-4 hidden">
        <h3 class="text-xl font-semibold text-purple-700 mb-4">üèÜ Team of the Week</h3>
        <div class="min-w-full">
            <div class="flex text-gray-600 border-b border-gray-200 py-2">
                <div class="w-1/2 text-left font-semibold">Player</div>
                <div class="w-1/2 pl-4 font-semibold">Count (Weeks)</div>
            </div>
            {% for player in team_of_the_week %}
            <div class="flex items-center border-t border-gray-200 py-2">
                <span class="w-1/2">
                    {{ player.player__name }}
                    <span class="text-xs text-gray-500">({{ player.player__team__name }})</span>
                </span>
                <span class="w-1/2 pl-4 font-medium text-purple-600">
                    {{ player.total_totw_count }}
                    <span class="text-xs text-gray-500">
                        ({{ player.week_numbers|join:", " }})
                    </span>
                </span>
            </div>
            {% endfor %}
        </div>
    </div>

</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const tabLinks = document.querySelectorAll('.tab-link');
        const tabContents = document.querySelectorAll('.tab-content');

        tabLinks.forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();

                // Deactivate all tabs and hide all content
                tabLinks.forEach(tab => {
                    tab.classList.remove('border-indigo-500', 'text-indigo-600');
                    tab.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
                });
                tabContents.forEach(content => {
                    content.classList.add('hidden');
                });

                // Activate the clicked tab and show its content
                this.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
                this.classList.add('border-indigo-500', 'text-indigo-600');

                const targetTabId = this.getAttribute('data-tab');
                document.getElementById(targetTabId).classList.remove('hidden');
            });
        });
    });
</script>
{% endblock %}